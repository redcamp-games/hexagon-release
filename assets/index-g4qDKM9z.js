const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./web-BYJ2HsKp.js","./phaser-Dp_CM4nq.js"])))=>i.map(i=>d[i]);
var e,t,s,i,n,a,o,r,l,h,c,d,g,u,m,p,f,b,y,w,x,E,v,C,S,k,P,O,T,L,A,M,W,D,B=Object.defineProperty,I=e=>{throw TypeError(e)},N=(e,t,s)=>((e,t,s)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s)(e,"symbol"!=typeof t?t+"":t,s),j=(e,t,s)=>t.has(e)||I("Cannot "+s),R=(e,t,s)=>(j(e,t,"read from private field"),s?s.call(e):t.get(e)),F=(e,t,s)=>t.has(e)?I("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,s),_=(e,t,s,i)=>(j(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),G=(e,t,s)=>(j(e,t,"access private method"),s);import{p as U,P as V}from"./phaser-Dp_CM4nq.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class Boot extends U.Scene{constructor(){super("Boot")}preload(){this.load.image("background","assets/background.jpg")}create(){this.scene.start("AppPreloader")}}const H=class _ExtendedScene extends U.Scene{constructor(i){super(i),F(this,e),F(this,t),F(this,s,{x:0,y:0})}init(){_(this,e,this.game.config.width),_(this,t,this.game.config.height),R(this,s).x=this.game.config.width/2,R(this,s).y=this.game.config.height/2}get width(){return R(this,e)}get height(){return R(this,t)}get center(){return R(this,s)}set background(e){this.add.image(R(this,s).x,R(this,s).y,e).setScale(this.height/_ExtendedScene.BACKGROUND_IMAGE_WIDTH)}goTo(e,t=300,s=null){this.cameras.main.fadeOut(t,_ExtendedScene.BACKGROUND_COLOR.red,_ExtendedScene.BACKGROUND_COLOR.green,_ExtendedScene.BACKGROUND_COLOR.blue,((t,i)=>{1===i&&(s?this.scene.start(e,s):this.scene.start(e))}))}fadeIn(e=300){this.cameras.main.fadeIn(e,_ExtendedScene.BACKGROUND_COLOR.red,_ExtendedScene.BACKGROUND_COLOR.green,_ExtendedScene.BACKGROUND_COLOR.blue)}};e=new WeakMap,t=new WeakMap,s=new WeakMap,N(H,"BACKGROUND_IMAGE_WIDTH",1920),N(H,"BACKGROUND_COLOR",new Phaser.Display.Color(22,16,20));let $=H;class Button extends V.GameObjects.Layer{constructor(e,t,s,c,d,g,u,m){super(e),F(this,r),F(this,i),F(this,n),F(this,a),F(this,o),_(this,i,e.add.nineslice(t,s,c,0,d,g,u,m)),R(this,i).setOrigin(.5),R(this,i).setInteractive(),R(this,i).on(V.Input.Events.GAMEOBJECT_POINTER_DOWN,(()=>{!0!==R(this,n)&&(R(this,o)||G(this,r,l).call(this))})),R(this,i).on(V.Input.Events.GAMEOBJECT_POINTER_OUT,(()=>{!0!==R(this,n)&&!0===R(this,o)&&G(this,r,h).call(this)})),R(this,i).on(V.Input.Events.GAMEOBJECT_POINTER_UP,(()=>{var e;!0!==R(this,n)&&(!0===R(this,o)&&G(this,r,h).call(this),null==(e=R(this,a))||e.call())})),this.add(R(this,i)),this.addToDisplayList()}set disabled(e){_(this,n,e),!0===e?R(this,i).setAlpha(.5):R(this,i).setAlpha(1)}set texture(e){R(this,i).texture=e}onClick(e){return _(this,a,e),this}setScale(e,t){R(this,i).setScale(e,t)}setOrigin(e,t){R(this,i).setOrigin(e,t)}}i=new WeakMap,n=new WeakMap,a=new WeakMap,o=new WeakMap,r=new WeakSet,l=function(){_(this,o,!0),this.getChildren().forEach((e=>{e.x+=4,e.y+=4}))},h=function(){this.getChildren().forEach((e=>{e.x-=4,e.y-=4})),_(this,o,!1)};class ImageButton extends Button{constructor(e,t,s,i,n,a){super(e,t,s,i,n,a,0,0)}}class PlayButton extends ImageButton{constructor(e,t,s,i=1){super(e,t,s,"play-button",410,429),this.setScale(i,i)}}const z={},Y=(e=>e.CapacitorPlatforms=(e=>{const t=new Map;t.set("web",{name:"web"});const s=e.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:t};return s.addPlatform=(e,t)=>{s.platforms.set(e,t)},s.setPlatform=e=>{s.platforms.has(e)&&(s.currentPlatform=s.platforms.get(e))},s})(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{});var X,K;Y.addPlatform,Y.setPlatform,(K=X||(X={})).Unimplemented="UNIMPLEMENTED",K.Unavailable="UNAVAILABLE";class CapacitorException extends Error{constructor(e,t,s){super(e),this.message=e,this.code=t,this.data=s}}const q=(e=>e.Capacitor=(e=>{var t,s,i,n,a;const o=e.CapacitorCustomPlatform||null,r=e.Capacitor||{},l=r.Plugins=r.Plugins||{},h=e.CapacitorPlatforms,c=(null===(t=null==h?void 0:h.currentPlatform)||void 0===t?void 0:t.getPlatform)||(()=>null!==o?o.name:(e=>{var t,s;return(null==e?void 0:e.androidBridge)?"android":(null===(s=null===(t=null==e?void 0:e.webkit)||void 0===t?void 0:t.messageHandlers)||void 0===s?void 0:s.bridge)?"ios":"web"})(e)),d=(null===(s=null==h?void 0:h.currentPlatform)||void 0===s?void 0:s.isNativePlatform)||(()=>"web"!==c()),g=(null===(i=null==h?void 0:h.currentPlatform)||void 0===i?void 0:i.isPluginAvailable)||(e=>{const t=m.get(e);return!!(null==t?void 0:t.platforms.has(c()))||!!u(e)}),u=(null===(n=null==h?void 0:h.currentPlatform)||void 0===n?void 0:n.getPluginHeader)||(e=>{var t;return null===(t=r.PluginHeaders)||void 0===t?void 0:t.find((t=>t.name===e))}),m=new Map,p=(null===(a=null==h?void 0:h.currentPlatform)||void 0===a?void 0:a.registerPlugin)||((e,t={})=>{const s=m.get(e);if(s)return console.warn(`Capacitor plugin "${e}" already registered. Cannot register plugins twice.`),s.proxy;const i=c(),n=u(e);let a;const h=s=>{let l;const h=(...h)=>{const c=(async()=>(!a&&i in t?a=a="function"==typeof t[i]?await t[i]():t[i]:null!==o&&!a&&"web"in t&&(a=a="function"==typeof t.web?await t.web():t.web),a))().then((t=>{const a=((t,s)=>{var a,o;if(!n){if(t)return null===(o=t[s])||void 0===o?void 0:o.bind(t);throw new CapacitorException(`"${e}" plugin is not implemented on ${i}`,X.Unimplemented)}{const i=null==n?void 0:n.methods.find((e=>s===e.name));if(i)return"promise"===i.rtype?t=>r.nativePromise(e,s.toString(),t):(t,i)=>r.nativeCallback(e,s.toString(),t,i);if(t)return null===(a=t[s])||void 0===a?void 0:a.bind(t)}})(t,s);if(a){const e=a(...h);return l=null==e?void 0:e.remove,e}throw new CapacitorException(`"${e}.${s}()" is not implemented on ${i}`,X.Unimplemented)}));return"addListener"===s&&(c.remove=async()=>l()),c};return h.toString=()=>`${s.toString()}() { [capacitor code] }`,Object.defineProperty(h,"name",{value:s,writable:!1,configurable:!1}),h},d=h("addListener"),g=h("removeListener"),p=(e,t)=>{const s=d({eventName:e},t),i=async()=>{const i=await s;g({eventName:e,callbackId:i},t)},n=new Promise((e=>s.then((()=>e({remove:i})))));return n.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await i()},n},f=new Proxy({},{get(e,t){switch(t){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return n?p:d;case"removeListener":return g;default:return h(t)}}});return l[e]=f,m.set(e,{name:e,proxy:f,platforms:new Set([...Object.keys(t),...n?[i]:[]])}),f});return r.convertFileSrc||(r.convertFileSrc=e=>e),r.getPlatform=c,r.handleError=t=>e.console.error(t),r.isNativePlatform=d,r.isPluginAvailable=g,r.pluginMethodNoop=(e,t,s)=>Promise.reject(`${s} does not have an implementation of "${t}".`),r.registerPlugin=p,r.Exception=CapacitorException,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r.platform=r.getPlatform(),r.isNative=r.isNativePlatform(),r})(e))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}),J=q.registerPlugin;q.Plugins;class WebPlugin{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,t){let s=!1;this.listeners[e]||(this.listeners[e]=[],s=!0),this.listeners[e].push(t);const i=this.windowListeners[e];return i&&!i.registered&&this.addWindowListener(i),s&&this.sendRetainedArgumentsForEvent(e),Promise.resolve({remove:async()=>this.removeListener(e,t)})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,s){const i=this.listeners[e];if(i)i.forEach((e=>e(t)));else if(s){let s=this.retainedEventArguments[e];s||(s=[]),s.push(t),this.retainedEventArguments[e]=s}}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:e=>{this.notifyListeners(t,e)}}}unimplemented(e="not implemented"){return new q.Exception(e,X.Unimplemented)}unavailable(e="not available"){return new q.Exception(e,X.Unavailable)}async removeListener(e,t){const s=this.listeners[e];if(!s)return;const i=s.indexOf(t);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach((t=>{this.notifyListeners(e,t)})))}}const Q=e=>encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Z=e=>e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class CapacitorCookiesPluginWeb extends WebPlugin{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach((e=>{if(e.length<=0)return;let[s,i]=e.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=Z(s).trim(),i=Z(i).trim(),t[s]=i})),t}async setCookie(e){try{const t=Q(e.key),s=Q(e.value),i=`; expires=${(e.expires||"").replace("expires=","")}`,n=(e.path||"/").replace("path=",""),a=null!=e.url&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${s||""}${i}; path=${n}; ${a};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}J("CapacitorCookies",{web:()=>new CapacitorCookiesPluginWeb});class CapacitorHttpPluginWeb extends WebPlugin{async request(e){const t=((e,t={})=>{const s=Object.assign({method:e.method||"GET",headers:e.headers},t),i=((e={})=>{const t=Object.keys(e);return Object.keys(e).map((e=>e.toLocaleLowerCase())).reduce(((s,i,n)=>(s[i]=e[t[n]],s)),{})})(e.headers)["content-type"]||"";if("string"==typeof e.data)s.body=e.data;else if(i.includes("application/x-www-form-urlencoded")){const t=new URLSearchParams;for(const[s,i]of Object.entries(e.data||{}))t.set(s,i);s.body=t.toString()}else if(i.includes("multipart/form-data")||e.data instanceof FormData){const t=new FormData;if(e.data instanceof FormData)e.data.forEach(((e,s)=>{t.append(s,e)}));else for(const s of Object.keys(e.data))t.append(s,e.data[s]);s.body=t;const i=new Headers(s.headers);i.delete("content-type"),s.headers=i}else(i.includes("application/json")||"object"==typeof e.data)&&(s.body=JSON.stringify(e.data));return s})(e,e.webFetchExtra),s=((e,t=!0)=>e?Object.entries(e).reduce(((e,s)=>{const[i,n]=s;let a,o;return Array.isArray(n)?(o="",n.forEach((e=>{a=t?encodeURIComponent(e):e,o+=`${i}=${a}&`})),o.slice(0,-1)):(a=t?encodeURIComponent(n):n,o=`${i}=${a}`),`${e}&${o}`}),"").substr(1):null)(e.params,e.shouldEncodeUrlParams),i=s?`${e.url}?${s}`:e.url,n=await fetch(i,t),a=n.headers.get("content-type")||"";let o,r,{responseType:l="text"}=n.ok?e:{};switch(a.includes("application/json")&&(l="json"),l){case"arraybuffer":case"blob":r=await n.blob(),o=await(async e=>new Promise(((t,s)=>{const i=new FileReader;i.onload=()=>{const e=i.result;t(e.indexOf(",")>=0?e.split(",")[1]:e)},i.onerror=e=>s(e),i.readAsDataURL(e)})))(r);break;case"json":o=await n.json();break;default:o=await n.text()}const h={};return n.headers.forEach(((e,t)=>{h[t]=e})),{data:o,headers:h,status:n.status,url:n.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}J("CapacitorHttp",{web:()=>new CapacitorHttpPluginWeb});const ee=J("Preferences",{web:()=>function(e,t,s){let i=Promise.resolve();if(t&&t.length>0){const e=document.getElementsByTagName("link"),n=document.querySelector("meta[property=csp-nonce]"),a=(null==n?void 0:n.nonce)||(null==n?void 0:n.getAttribute("nonce"));i=Promise.allSettled(t.map((t=>{if(t=function(e,t){return new URL(e,t).href}(t,s),t in z)return;z[t]=!0;const i=t.endsWith(".css"),n=i?'[rel="stylesheet"]':"";if(s)for(let s=e.length-1;s>=0;s--){const n=e[s];if(n.href===t&&(!i||"stylesheet"===n.rel))return}else if(document.querySelector(`link[href="${t}"]${n}`))return;const o=document.createElement("link");return o.rel=i?"stylesheet":"modulepreload",i||(o.as="script"),o.crossOrigin="",o.href=t,a&&o.setAttribute("nonce",a),document.head.appendChild(o),i?new Promise(((e,s)=>{o.addEventListener("load",e),o.addEventListener("error",(()=>s(new Error(`Unable to preload CSS for ${t}`))))})):void 0})))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return i.then((t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)}))}((()=>import("./web-BYJ2HsKp.js")),__vite__mapDeps([0,1]),import.meta.url).then((e=>new e.PreferencesWeb))});class PreferencesPlugin{constructor(e,t){this.pluginManager=t,this.game=t.game,this.scene=e,this.systems=e.sys}boot(){}async setData(e,t){await ee.set({key:e,value:JSON.stringify(t)})}async getData(e){const t=await ee.get({key:e});return JSON.parse(t.value)}}const te=[{width:900,height:1350},{width:640,height:960}];class Utils{static calculateSize(e=1){let t,s,i=te[0].width,n=te[0].height,a=te[1].width,o=te[1].height;e===this.LANDSCAPE&&(i=te[0].height,n=te[0].width,a=te[1].height,o=te[1].width);const r=window.innerWidth*window.devicePixelRatio,l=window.innerHeight*window.devicePixelRatio;return r/l>1.5?l>o?(s=n,t=r*(n/l)):(s=o,t=r*(o/l)):r>a?(t=i,s=l*(i/r)):(t=a,s=l*(a/r)),{width:t,height:s}}}N(Utils,"PORTRAIT",1),N(Utils,"LANDSCAPE",2);class Preloader extends ${constructor(e){if(super(e),new.target===Preloader)throw new TypeError("Cannot construct Preloader instances directly")}init(){super.init(),this.background="background",this.add.text(this.center.x,this.center.y,"LOADING...",{fontFamily:"Titillium Web",fontSize:96,fontStyle:"bold",color:"#ffffff",align:"center"}).setOrigin(.5)}}class FloatingNumbersPlugin{constructor(e,t){this.pluginManager=t,this.game=t.game,this.scene=e,this.systems=e.sys,e.sys.events.once("boot",this.boot,this),this.tooltipCollection={},this.configObj={align:"center",textOptions:{},offsetX:0,offsetY:0,animation:"up",timeToLive:400,animationDistance:50,animationEase:"Sine.easeOut",fixedToCamera:!1,text:"",store:!1,textType:"normal",parentObject:null,target:this.scene,pointX:[],pointY:[]}}createFloatingText(e){let t=Object.assign(this.configObj,e),s={};if("normal"===t.textType){if(s=this.scene.add.text(0,0,t.text,t.textOptions),s.setOrigin(.5),s.depth=99999,null!==t.parentObject&&("center"===t.align?Phaser.Display.Align.In.Center(s,t.parentObject,t.offsetX,t.offsetY):"left"===t.align?Phaser.Display.Align.In.LeftCenter(s,t.parentObject,t.offsetX,t.offsetY):"right"===t.align?Phaser.Display.Align.In.RightCenter(s,t.parentObject,t.offsetX,t.offsetY):"top-center"===t.align?Phaser.Display.Align.In.TopCenter(s,t.parentObject,t.offsetX,t.offsetY):"bottom-center"===t.align&&Phaser.Display.Align.In.BottomCenter(s,t.parentObject,t.offsetX,t.offsetY)),s.isAnimating=!1,!1!==t.store)return s;this.scene.children.bringToTop(s),this.animateText(t,s)}}animateText(e,t){let s,i,n,a,o;const r={t:0,vec:new Phaser.Math.Vector2};if(!1===t.isAnimating)if(t.isAnimating=!0,"physics"===e.animation);else if("custom"===e.animation)e.pointX.length>0&&e.pointY.length>0&&(s=new Phaser.Math.Vector2(e.pointX[0],e.pointY[0]),i=new Phaser.Math.Vector2(e.pointX[1],e.pointY[1]),n=new Phaser.Math.Vector2(e.pointX[2],e.pointY[2]),a=new Phaser.Math.Vector2(e.pointX[3],e.pointY[3]),o=new Phaser.Curves.CubicBezier(s,i,n,a),this.scene.tweens.add({targets:r,t:1,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onUpdate:function(){let e=o.getPoint(r.t,r.vec);t.x=e.x,t.y=e.y}}));else if("explode"===e.animation)this.scene.tweens.add({targets:t,y:t.y-e.animationDistance,scale:1.6,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){this.scene.tweens.add({targets:t,alpha:0,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){t.destroy()}})}});else if("fade"===e.animation)t.alpha=0,this.scene.tweens.add({targets:t,alpha:1,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){this.scene.tweens.add({targets:t,alpha:0,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){t.destroy()}})}});else if("smoke"===e.animation){let l=1;Math.round(10*Math.random())>5&&(l*=-1),s=new Phaser.Math.Vector2(t.x+25*l,t.y-25),i=new Phaser.Math.Vector2(t.x-50*l,t.y-50),n=new Phaser.Math.Vector2(t.x+75*l,t.y-75),a=new Phaser.Math.Vector2(t.x-25*l,t.y-100),o=new Phaser.Curves.CubicBezier(s,i,n,a),this.scene.tweens.add({targets:r,t:1,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){this.scene.tweens.add({targets:t,alpha:0,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){t.destroy()}})},onUpdate:function(){let e=o.getPoint(r.t,r.vec);t.x=e.x,t.y=e.y}})}else"left"===e.animation?this.scene.tweens.add({targets:t,y:t.x-e.animationDistance,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){this.scene.tweens.add({targets:t,alpha:0,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){t.destroy()}})}}):"right"===e.animation?this.scene.tweens.add({targets:t,y:t.x+e.animationDistance,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){this.scene.tweens.add({targets:t,alpha:0,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){t.destroy()}})}}):"up"===e.animation?this.scene.tweens.add({targets:t,y:t.y-e.animationDistance,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){this.scene.tweens.add({targets:t,alpha:0,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){t.destroy()}})}}):"down"===e.animation&&this.scene.tweens.add({targets:t,y:t.y+e.animationDistance,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){this.scene.tweens.add({targets:t,alpha:0,ease:e.animationEase,duration:e.timeToLive,yoyo:!1,callbackScope:this,onComplete:function(){t.destroy()}})}})}boot(){this.systems.events.once("destroy",this.destroy,this),this.systems.settings.active?this.start():this.systems.events.on("start",this.start,this)}start(){this.systems.events.on("update",this.update,this),this.systems.events.once("shutdown",this.shutdown,this)}update(e){}shutdown(){const e=this.systems.events;e.off("update",this.update,this),e.off("shutdown",this.shutdown,this)}destroy(){this.shutdown()}hideTooltip(e,t){t?(this.scene.tweens.isTweening(this.tooltipCollection[e])&&this.scene.tweens.killTweensOf(this.tooltipCollection[e]),this.tween=this.scene.tweens.add({targets:this.tooltipCollection[e],alpha:0,ease:"Power1",duration:250,delay:0,onComplete:e=>{}})):this.tooltipCollection[e].visible=!1}showTooltip(e,t){t?(this.tooltipCollection[e].alpha=0,this.tooltipCollection[e].visible=!0,this.scene.children.bringToTop(this.tooltipCollection[e]),this.scene.tweens.isTweening(this.tooltipCollection[e])&&this.scene.tweens.killTweensOf(this.tooltipCollection[e]),this.tween=this.scene.tweens.add({targets:this.tooltipCollection[e],alpha:1,ease:"Power1",duration:500,delay:0,onComplete:e=>{}})):(this.tooltipCollection[e].visible=!0,this.scene.children.bringToTop(this.tooltipCollection[e]))}createTooltip(e){let t,s=this.scene.add.container(e.x,e.y),i=this.createLabel(s,e.x,e.y,e);return e.hasBackground&&(t=this.createBackground(s,i,e.x,e.y,e.background.width,e.background.height,e),i.x=t.rect.centerX-.5*i.displayWidth,i.y=t.rect.centerY-.5*i.displayHeight),s.add(i),s.x=e.x,s.y=e.y,console.log(e,s,t),this.tooltipCollection[e.id]=s,s}createLabel(e,t,s,i){let n=this.scene.add.text(t,s,i.text.text,{fontFamily:i.text.fontFamily||"new_rockerregular",fontSize:i.text.fontSize||19,color:i.text.textColor||"#ffffff",fontStyle:i.text.fontStyle||"",align:i.text.align||"center"});if(console.log(i),i.hasShadow){let e=i.text.shadowColor||"#1e1e1e",t=i.text.blur||1,s=i.text.shadowStroke||!1,a=i.text.shadowFill||!0;n.setShadow(0,0,e,t,s,a)}return n}}class Hexagon extends V.GameObjects.Layer{constructor(e,t,s,i=1){super(e),N(this,"x",0),N(this,"y",0),F(this,c),F(this,d),F(this,g),F(this,u),N(this,"edges",[]),this.x=t,this.y=s,_(this,c,i),_(this,d,he.getColorByValue(i));const n=e.add.image(t,s,"hexagon");n.on(V.Input.Events.GAMEOBJECT_POINTER_DOWN,(()=>{var e;null==(e=R(this,u))||e.call(null,this)})).setInteractive({pixelPerfect:!1}),_(this,g,e.add.text(t,s,`${R(this,c)}`,{fontFamily:"Titillium Web",fontSize:he.getFontSizeByValue(i),fontStyle:"normal",color:`${R(this,d)}`}).setOrigin(.5).setVisible(R(this,c)>1)),this.add(n),this.add(R(this,g)),this.addToDisplayList(),this.edges[0]=null,this.edges[1]=null,this.edges[2]=null,this.edges[3]=null,this.edges[4]=null,this.edges[5]=null}set number(e){_(this,c,e),_(this,d,he.getColorByValue(e)),R(this,g).text=R(this,c),R(this,g).setFontSize(he.getFontSizeByValue(e)),R(this,g).setColor(R(this,d)),R(this,g).setVisible(R(this,c)>1),this.isEmpty()||this.scene.events.emit(he.SCORE_UPDATE,R(this,c))}get number(){return R(this,c)}setEdge(e,t){this.edges[t]=e,e.edges[(t+3)%this.edges.length]=this}findMatching(e){const t=e||this.number;return this.edges.filter((e=>null!==e&&t===e.number))}startMerge(){const e=this.findMatching();if(e.length>1)e.forEach((e=>e.merge(this))),this.scene.time.delayedCall(300,(()=>{this.number*=2,this.startMerge()}));else if(1===e.length){const t=e[0],s=this.simulateMerge(t);t.simulateMerge(this)>s?(t.merge(this),this.scene.time.delayedCall(300,(()=>{this.number*=2,this.startMerge()}))):(this.merge(t),this.scene.time.delayedCall(300,(()=>{t.number*=2,t.startMerge()})))}else this.scene.events.emit(he.MERGE_END)}merge(e){this.scene.tweens.add({targets:R(this,g),x:e.x,y:e.y,ease:"Circ.easeInOut",duration:300,onComplete:()=>{this.clear(),R(this,g).setPosition(this.x,this.y)}})}simulateMerge(e){let t=2*e.number;const s=e.findMatching(t);let i;return s.length>0&&(i=s[0],t+=e.simulateMerge(i)),t}isEmpty(){return 1===R(this,c)}clear(){this.number=1}onClick(e){return _(this,u,e),this}setScale(e){return this.getChildren().forEach((t=>t.setScale(e))),this}}c=new WeakMap,d=new WeakMap,g=new WeakMap,u=new WeakMap;class HexaButton extends Phaser.GameObjects.Layer{constructor(e,t,s,i=2){super(e),N(this,"x",0),N(this,"y",0),F(this,m),F(this,p),F(this,f),F(this,b),this.x=t,this.y=s,_(this,m,i),_(this,p,he.getColorByValue(i)),_(this,f,e.add.image(t,s,"hexa-button")),_(this,b,e.add.text(t,s,`${R(this,m)}`,{fontFamily:"Titillium Web",fontSize:128,fontStyle:"normal",color:`${R(this,p)}`}).setOrigin(.5,.55)),this.add(R(this,f)),this.add(R(this,b)),this.addToDisplayList()}set number(e){_(this,m,e),_(this,p,he.getColorByValue(e)),R(this,b).text=R(this,m),R(this,b).setColor(R(this,p))}get number(){return R(this,m)}setPosition(e,t){this.x=e,this.y=t,this.getChildren().forEach((s=>s.setPosition(e,t)))}setScale(e){return this.getChildren().forEach((t=>t.setScale(e))),this}}m=new WeakMap,p=new WeakMap,f=new WeakMap,b=new WeakMap;const se=[2,4,8,16,32,64],ie={1:"#AFA690",2:"#5a6fbc",4:"#5ABD63",8:"#5AB4BC",16:"#b9bc5a",32:"#6c5abc",64:"#ac5abc",128:"#bc5a7e",256:"#bc9b5a",512:"#bc5a5a",1024:"#bc855a",2048:"#AFA690"},ne=[96,96,96,84,72,60,48,36],ae=[{level:1,targetScore:256},{level:2,targetScore:512},{level:3,targetScore:1024},{level:4,targetScore:2048},{level:5,targetScore:4096},{level:6,targetScore:8192},{level:7,targetScore:16384},{level:8,targetScore:32768},{level:9,targetScore:65536},{level:10,targetScore:131072}],oe=144,re=163,le=class _Game extends ${constructor(){super("Game"),F(this,y),F(this,w,0),F(this,x,0),F(this,E,-1),F(this,v),F(this,C),F(this,S),F(this,k),F(this,P),F(this,O),F(this,T),F(this,L),N(this,"floatingNumbers"),N(this,"preferences"),F(this,A,!1),F(this,M),F(this,W),F(this,D)}static getColorByValue(e){return e>2048?_Game.getColorByValue(e/2048):ie[e]}static getFontSizeByValue(e){const t=`${e}`.length;return ne[Math.min(t,7)]}preload(){this.load.scenePlugin("floatingNumbersPlugin",FloatingNumbersPlugin,"floatingNumbersPlugin","floatingNumbers"),this.load.scenePlugin("preferencesPlugin",PreferencesPlugin,"preferencesPlugin","preferences")}create(){this.background="background",this.fadeIn(),_(this,y,ae[0]),_(this,x,0),_(this,w,0),_(this,E,-1),_(this,v,[]),this.preferences.getData("highScore").then((e=>_(this,E,e||0))),this.events.off(_Game.SCORE_UPDATE).on(_Game.SCORE_UPDATE,(e=>{var t;e>R(this,x)&&(_(this,x,e),this.setProgress(e,R(this,y).targetScore)),e>R(this,w)&&(_(this,w,e),this.score.text=e,(null==(t=R(this,M))?void 0:t.isPlaying())&&(R(this,M).complete(),this.score.setScale(1)),_(this,M,this.tweens.add({targets:this.score,scale:2,ease:"Sine.easeInOut",duration:150,yoyo:!0})),R(this,E)>-1&&e>R(this,E)&&this.preferences.setData("highScore",e))})),this.events.off(_Game.MERGE_END).on(_Game.MERGE_END,(()=>_(this,A,!1)));const e=100+this.game.registry.get("mobile").safeArea.top;this.add.nineslice(this.center.x,e,"level-title",0,this.width-360,121,40,40),_(this,S,this.add.text(this.center.x,e-2,`LEVEL ${R(this,y)}`,{fontFamily:"Titillium Web",fontSize:72,fontStyle:"bold",color:"#afa68f",align:"center"}).setOrigin(.5)),new ImageButton(this,100,e,"back-button",107,111).onClick((()=>this.goTo("Menu"))),new ImageButton(this,this.width-100,e,"settings-button",107,111).onClick((()=>{})),this.add.image(this.center.x,300,"score").setScale(.8),this.score=this.add.text(this.center.x,380,"0",{fontFamily:"Titillium Web",fontSize:64,fontStyle:"bold",color:"#806600"}).setOrigin(.5);const t=this.width-300;_(this,k,t-58.199999999999996-1.4*48.5+1);let s=500;this.add.image(80,s,"flag").setScale(1.2),this.add.image(200,s,"target-path").setOrigin(0,.5).setDisplaySize(t,10),this.add.image(200,s,"target",1).setScale(1.2),_(this,P,this.add.rectangle(258.2,s,1,10,13121335).setOrigin(0,.5)),_(this,O,this.add.image(this.width-100,s,"target",0).setScale(1.4)),_(this,T,this.add.text(200,s,"0",{fontFamily:"Titillium Web",fontSize:40,fontStyle:"bold",color:"#c83737"}).setOrigin(.5)),_(this,L,this.add.text(this.width-100,s,R(this,y).targetScore,{fontFamily:"Titillium Web",fontSize:48,fontStyle:"bold",color:"#806600"}).setOrigin(.5)),this.buildInitialGraph(),this.setLevel(1),_(this,C,this.add.image(this.center.x,this.center.y,"board").setScale(.9));const i=5*this.height/6;this.current=new HexaButton(this,this.center.x,i,2),this.nextX=4*this.width/5,this.nextY=i-100,this.next=new HexaButton(this,this.nextX,this.nextY,2).setAlpha(.4).setScale(.8),_(this,W,this.add.sprite(this.center.x,this.center.y,"power-burst").setScale(4).setVisible(!1))}setProgress(e,t){let s=Math.floor(R(this,k)*e/t);R(this,T).text=e,R(this,T).setFontSize(e>8192?32:40),R(this,L).text=t,R(this,L).setFontSize(t>8192?40:48),R(this,P).displayWidth=s,e>=t&&this.changeLevel()}changeLevel(){R(this,W).play("powerburst"),this.showFloatingText("LEVEL COMPLETE",R(this,C)),R(this,O).setFrame(1),R(this,C).setInteractive(),this.time.delayedCall(3e3,(()=>{let e=R(this,y).level+1;this.setLevel(e),R(this,O).setFrame(0),R(this,v).forEach((e=>e.clear())),this.extendBoard(e),this.time.delayedCall(1e3,(()=>R(this,C).disableInteractive()))}))}buildInitialGraph(){const e=new Hexagon(this,this.center.x-oe,this.center.y-81.5).onClick((e=>this.tap(e))),t=new Hexagon(this,this.center.x,this.center.y-re).onClick((e=>this.tap(e))),s=new Hexagon(this,this.center.x+oe,this.center.y-81.5).onClick((e=>this.tap(e))),i=new Hexagon(this,this.center.x,this.center.y).onClick((e=>this.tap(e))),n=new Hexagon(this,this.center.x+oe,this.center.y+81.5).onClick((e=>this.tap(e))),a=new Hexagon(this,this.center.x,this.center.y+re).onClick((e=>this.tap(e))),o=new Hexagon(this,this.center.x-oe,this.center.y+81.5).onClick((e=>this.tap(e)));R(this,v).push(i),R(this,v).push(t),R(this,v).push(s),R(this,v).push(n),R(this,v).push(a),R(this,v).push(o),R(this,v).push(e),e.setEdge(t,1),e.setEdge(i,2),e.setEdge(o,3),t.setEdge(s,2),t.setEdge(i,3),s.setEdge(n,3),s.setEdge(i,4),i.setEdge(n,2),i.setEdge(a,3),i.setEdge(o,4),n.setEdge(a,4),a.setEdge(o,5)}extendBoard(e){if(2===e){const e=R(this,v)[6],t=R(this,v)[1],s=new Hexagon(this,e.x,e.y-re).onClick((e=>this.tap(e))).setScale(.1).setVisible(!1);s.setEdge(e,3),s.setEdge(t,2),R(this,v)[7]=s;const i=R(this,v)[2],n=R(this,v)[3],a=new Hexagon(this,n.x+oe,n.y-81.5).onClick((e=>this.tap(e))).setScale(.1).setVisible(!1);a.setEdge(i,5),a.setEdge(n,4),R(this,v)[11]=a;const o=R(this,v)[4],r=R(this,v)[5],l=new Hexagon(this,r.x,r.y+re).onClick((e=>this.tap(e))).setScale(.1).setVisible(!1);l.setEdge(o,1),l.setEdge(r,0),R(this,v)[15]=l,this.showHexagons(s,a,l)}if(3===e){const e=R(this,v)[1],t=R(this,v)[2],s=new Hexagon(this,t.x,t.y-re).onClick((e=>this.tap(e))).setScale(.1).setVisible(!1);s.setEdge(e,4),s.setEdge(t,3),R(this,v)[9]=s;const i=R(this,v)[3],n=R(this,v)[4],a=new Hexagon(this,i.x,i.y+re).onClick((e=>this.tap(e))).setScale(.1).setVisible(!1);a.setEdge(i,0),a.setEdge(n,5),R(this,v)[13]=a;const o=R(this,v)[5],r=R(this,v)[6],l=new Hexagon(this,o.x-oe,o.y-81.5).onClick((e=>this.tap(e))).setScale(.1).setVisible(!1);l.setEdge(o,2),l.setEdge(r,1),R(this,v)[17]=l,this.showHexagons(s,a,l)}if(4===e){const e=R(this,v)[17],t=R(this,v)[7],s=R(this,v)[6],i=new Hexagon(this,s.x-oe,s.y-81.5).onClick((e=>this.tap(e))).setScale(.1).setVisible(!1);i.setEdge(e,3),i.setEdge(t,1),i.setEdge(s,2),R(this,v)[18]=i;const n=R(this,v)[11],a=R(this,v)[9],o=R(this,v)[2],r=new Hexagon(this,o.x+oe,o.y-81.5).onClick((e=>this.tap(e))).setScale(.1).setVisible(!1);r.setEdge(n,3),r.setEdge(a,5),r.setEdge(o,4),R(this,v)[10]=r;const l=R(this,v)[15],h=R(this,v)[13],c=R(this,v)[4],d=new Hexagon(this,c.x,c.y+re).onClick((e=>this.tap(e))).setScale(.1).setVisible(!1);d.setEdge(l,5),d.setEdge(h,1),d.setEdge(c,0),R(this,v)[14]=d,this.showHexagons(i,r,d)}if(5===e){const e=R(this,v)[9],t=R(this,v)[7],s=R(this,v)[1],i=new Hexagon(this,s.x,s.y-re).onClick((e=>this.tap(e))).setScale(.1).setVisible(!1);i.setEdge(e,2),i.setEdge(t,4),i.setEdge(s,3),R(this,v)[8]=i;const n=R(this,v)[13],a=R(this,v)[11],o=R(this,v)[3],r=new Hexagon(this,o.x+oe,o.y+81.5).onClick((e=>this.tap(e))).setScale(.1).setVisible(!1);r.setEdge(n,4),r.setEdge(a,0),r.setEdge(o,5),R(this,v)[12]=r;const l=R(this,v)[17],h=R(this,v)[15],c=R(this,v)[5],d=new Hexagon(this,c.x-oe,c.y+81.5).onClick((e=>this.tap(e))).setScale(.1).setVisible(!1);d.setEdge(l,0),d.setEdge(h,2),d.setEdge(c,1),R(this,v)[16]=d,this.showHexagons(i,r,d)}}showHexagons(e,t,s){this.tweens.chain({tweens:[{targets:e.getChildren(),scale:1,ease:"Circ.easeInOut",duration:200,onStart:t=>e.setVisible(!0)},{targets:t.getChildren(),scale:1,ease:"Circ.easeInOut",duration:200,onStart:e=>t.setVisible(!0)},{targets:s.getChildren(),scale:1,ease:"Circ.easeInOut",duration:200,onStart:e=>s.setVisible(!0)}]})}setLevel(e){e>ae.length?console.log("Game is complete!"):(_(this,y,ae[e-1]),R(this,S).text=`LEVEL ${R(this,y).level}`,_(this,x,0),this.setProgress(0,R(this,y).targetScore))}randomNumber(){return se.at(Math.floor(Math.random()*se.length))}tap(e){var t;if(!e.isEmpty()||R(this,A))return;(null==(t=R(this,D))?void 0:t.isPlaying())&&R(this,D).complete(),_(this,A,!0);const s=this.current.setVisible(!1);e.number=this.current.number,e.startMerge(),_(this,D,this.tweens.add({targets:this.next.getChildren(),scale:1,x:this.current.x,y:this.current.y,ease:"Circ.easeInOut",duration:300,onStart:()=>{this.next.setAlpha(1)},onComplete:()=>{this.next.x=this.current.x,this.next.y=this.current.y,this.current=this.next,this.next=s.setAlpha(.4).setScale(.8),this.next.setPosition(this.nextX,this.nextY),this.next.number=this.randomNumber(),this.next.setVisible(!0),this.checkIfGameOver()}}))}checkIfGameOver(){R(this,v).some((e=>e.isEmpty()))||this.onGameOver()}onGameOver(){this.cameras.main.shake(200,.02),this.time.delayedCall(1e3,(()=>{this.scene.pause(),this.scene.run("GameOver",{score:R(this,w)})}))}showFloatingText(e,t,s="#F5FAF5"){this.floatingNumbers.createFloatingText({textOptions:{fontFamily:"Titillium Web",fontSize:96,fontStyle:"bold",color:s,strokeThickness:2,stroke:"#E1E8D9"},text:e,align:"center",parentObject:t,offsetY:50,animation:"up",animationDistance:this.height/2-100,animationEase:"Sine.easeOut",timeToLive:1e3})}showSmokingText(e,t,s="#eee"){this.floatingNumbers.createFloatingText({textOptions:{fontFamily:"Titillium Web",fontSize:32,color:s,strokeThickness:2,stroke:"#000"},text:e,align:"center",offsetY:50,parentObject:t,animation:"smoke",animationDistance:200,animationEase:"Sine.easeOut"})}showExplodingText(e,t,s="#eee"){this.floatingNumbers.createFloatingText({textOptions:{fontFamily:"Titillium Web",fontSize:32,color:s,strokeThickness:2,stroke:"#000"},text:e,align:"center",offsetY:50,parentObject:t,animation:"explode",animationDistance:200,animationEase:"Sine.easeOut"})}};y=new WeakMap,w=new WeakMap,x=new WeakMap,E=new WeakMap,v=new WeakMap,C=new WeakMap,S=new WeakMap,k=new WeakMap,P=new WeakMap,O=new WeakMap,T=new WeakMap,L=new WeakMap,A=new WeakMap,M=new WeakMap,W=new WeakMap,D=new WeakMap,N(le,"SCORE_UPDATE","score.update"),N(le,"MERGE_END","hexagon.merge.end");let he=le;const ce=Utils.calculateSize(Utils.PORTRAIT),de={type:Phaser.AUTO,width:ce.width,height:ce.height,parent:"game-container",backgroundColor:"#5bbdae",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},scene:[Boot,class AppPreloader extends Preloader{constructor(){super("AppPreloader")}preload(){this.load.setPath("assets"),this.load.image("ribbon-title","ribbon-title.png"),this.load.image("play-button","play-button.png"),this.load.image("rank-button","rank-button.png"),this.load.image("share-button","share-button.png"),this.load.image("back-button","back-button.png"),this.load.image("settings-button","settings-button.png"),this.load.image("restart-button","restart-button.png"),this.load.image("hexa-button","hexa-button.png"),this.load.image("board","board.png"),this.load.image("diamond","diamond.png"),this.load.image("hexagon","hexagon.png"),this.load.image("score","score.png"),this.load.image("game-over","game-over.png"),this.load.image("level-title","level-title.png"),this.load.image("flag","flag.png"),this.load.image("target-path","target-path.png"),this.load.spritesheet("target","target.png",{frameWidth:97}),this.load.spritesheet("power-burst","animations/power-burst-star-v7.png",{frameWidth:256})}create(){this.anims.create({key:"powerburst",frames:"power-burst",frameRate:32,showOnStart:!0,hideOnComplete:!0}),this.goTo("Menu")}},class Menu extends ${constructor(){super("Menu"),N(this,"preferences")}preload(){this.load.scenePlugin("preferencesPlugin",PreferencesPlugin,"preferencesPlugin","preferences")}create(){this.background="background",this.fadeIn();const e=this.game.registry.get("mobile"),t=this.height/3,s=100+e.safeArea.top;new ImageButton(this,this.width-100,s,"settings-button",107,111),this.add.image(this.center.x,t,"game-over").setOrigin(.5).setScale(.9),this.add.image(this.center.x,400,"ribbon-title").setOrigin(.5).setScale(.9),this.add.image(this.center.x,t+180,"score").setScale(.8),this.score=this.add.text(this.center.x,t+264,"...",{fontFamily:"Titillium Web",fontSize:90,fontStyle:"bold",color:"#806600"}).setOrigin(.5),new PlayButton(this,this.center.x,2*this.height/3).onClick((()=>this.goTo("Game",300))).setScale(.9),new ImageButton(this,this.width/4,5*this.height/6,"share-button",256,301).setScale(.9),new ImageButton(this,3*this.width/4,5*this.height/6,"rank-button",256,301).setScale(.9),this.preferences.getData("highScore").then((e=>this.score.text=`${e||0}`))}},class GameOver extends ${constructor(){super("GameOver")}create(e){this.background="background",this.scene.moveUp();const t=this.game.registry.get("mobile"),s=this.height/3,i=100+t.safeArea.top;new ImageButton(this,100,i,"back-button",107,111).onClick((()=>{this.scene.stop("Game"),this.goTo("Menu")})),this.add.image(this.center.x,s,"game-over").setOrigin(.5).setScale(.9),this.add.image(this.center.x,s-180,"score"),this.add.text(this.center.x,s-40,`${e.score}`,{fontFamily:"Titillium Web",fontSize:100,color:"#806600",fontStyle:"bold",align:"center"}).setOrigin(.5),this.add.text(this.center.x,s+220,"RETRY?",{fontFamily:"Titillium Web",fontSize:90,fontStyle:"bold",color:"#AFA68F"}).setOrigin(.5),new ImageButton(this,this.center.x,this.center.y+300,"restart-button",256,301).onClick((()=>{this.scene.stop("Game"),this.goTo("Game")}))}},he]};de.callbacks={preBoot:e=>e.registry.merge({mobile:{safeArea:{top:0,right:0,bottom:0,left:0}}}),postBoot:e=>{console.log(window.Telegram.WebApp.initData)}},new Phaser.Game(de);export{WebPlugin as W};
